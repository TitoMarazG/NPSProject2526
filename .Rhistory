library(plot.matrix)
dataset <- read.csv("/Users/leomarcellopoli/Documents/Applied/Project/data_medione.csv")
View(dataset)
dataset <- read.csv("/Users/leomarcellopoli/Documents/Applied/Project/data_mediamese.csv")
dataset <- read.csv("/Users/leomarcellopoli/Documents/Applied/Project/dati_mediamese.csv")
View(dataset)
head(dataset)
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)]
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)]
dataset <- read.csv("/Users/leomarcellopoli/Documents/Applied/Project/dati_mediamese.csv")
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)]
names(dataset)
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)]
dataset <- dataset[, c(1, 3, 2, 4:ncol(df))]
dataset <- dataset[, c(1, 3, 2, 4:ncol(dataset))]
dataset <- dataset[, c(1, 3, 2, 4:ncol(dataset))]
dataset <- dataset[, c(1, 3, 2, 4:ncol(dataset))]
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)]
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month)]
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month), ]
dataset <- read.csv("/Users/leomarcellopoli/Documents/Applied/Project/dati_mediamese.csv")
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month), ]
dataset <- dataset[order(dataset$buoy_id, dataset$year, dataset$month), ]
dataset$month_year <- paste(sprintf("%02d", dataset$month), dataset$year, sep = "-")
xy1 <- xyplot(temperature ~ month_year,
groups = buoy_id,
data = dataset,
type = "l", lty = 1)
update(xy1, xlab = "Time (in weeks)",
ylab = "Visual acuity",
grid = "h")
remove(month_year)
dataset$month_year <- NULL
dataset$month_year <- as.Date(paste(dataset$year, dataset$month, "01", sep = "-"))
xy1 <- xyplot(temperature ~ month_year,
groups = buoy_id,
data = dataset,
type = "l", lty = 1)
xy1 <- xyplot(temperature ~ month_year,
groups = buoy_id,
data = dataset,
type = "l", lty = 1)
xy1 <- xyplot(temperature ~ month_year,
groups = buoy_id,
data = dataset,
type = "l", lty = 1)
update(xy1, xlab = "Time (in months)",
ylab = "Temperature",
grid = "h")
# sample means across time and coordinates
flst <- list(dataset$month_year.f, dataset$lat.f, dataset$lon.f)
View(flst)
View(flst)
# sample means across time and coordinates
flst <- list(dataset$month_year.f, dataset$lat.f, dataset$lon.f)
mean <- tapply(armd$temperature, flst, FUN = mean)
# sample means across time and coordinates
flst <- list(dataset$month_year.f, dataset$lat.f, dataset$lon.f)
mean <- tapply(dataset$temperature, flst, FUN = mean)
tMn
# sample means across time and coordinates
flst <- list(dataset$month_year.f, dataset$lat.f, dataset$lon.f)
sample_mean <- tapply(dataset$temperature, flst, FUN = mean)
length(dataset$temperature)
length(dataset$month_year)
length(dataset$lat)
length(dataset$lon)
# sample means across time and coordinates
flst <- list(dataset$year)
sample_mean <- tapply(dataset$temperature, flst, FUN = mean)
sample_mean
## Box-plots for visual acuity by treatment and time
bw1 <- bwplot(temperature ~ year,
data = dataset)
xlims <- c("Base", "4\nwks", "12\nwks", "24\nwks", "52\nwks")
update(bw1, xlim = xlims, pch = "|")
xlims <- c("2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024", "2025")
update(bw1, xlim = xlims, pch = "|")
## Box-plots for visual acuity by treatment and time
bw1 <- bwplot(temperature ~ year,
data = dataset)
xlims <- c("2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024", "2025")
update(bw1, xlim = xlims, pch = "|")
## Box-plots for visual acuity by treatment and time
bw1 <- bwplot(temperature ~ year.f,
data = dataset)
xlims <- c("2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024", "2025")
## Box-plots for visual acuity by treatment and time
bw1 <- bwplot(temperature ~ year,
data = dataset)
xlims <- levels(dataset$year)
update(bw1, xlim = xlims, pch = "|")
dataset$month_year <- as.Date(paste(dataset$year, dataset$month, "01", sep = "-"))
dataset$year <- factor(dataset$year)  # Assicurati che year sia un fattore
## Box-plots for visual acuity by treatment and time
bw1 <- bwplot(temperature ~ year,
data = dataset)
update(bw1, xlim = xlims, pch = "|")
## Box-plots for visual acuity by treatment and time
bw1 <- bwplot(temperature ~ year,
data = dataset)
bw1
# Leggi lo shapefile
# Attenzione!: il file da usare è quello .shp
# ci mette un po'
seas <- st_read("/Users/leomarcellopoli/Documents/Applied/Project/Script Marchesin/World_Seas_IHO_v3 copia/World_Seas_IHO_v3.shp")
library(sp)               ## Data management
library(lattice)          ## Data management
library(latticeExtra)
library(geoR)             ## Geostatistics
library(gstat)            ## Geostatistics
library(raster)           ## Per creare la griglia
library(sf)               ## Per le coste
library(rnaturalearth)    ##
library(dplyr)
# Leggi lo shapefile
# Attenzione!: il file da usare è quello .shp
# ci mette un po'
seas <- st_read("/Users/leomarcellopoli/Documents/Applied/Project/Script Marchesin/World_Seas_IHO_v3 copia/World_Seas_IHO_v3.shp")
z <- var
A <- [z -2, -0.5 z-3]
A <- c(z, -2, -0.5, z-3)
A <- matrix(c(z - 2, -0.5 * z - 3), nrow = 1)
A <- matrix(c(z -2, -0.5  z-3), nrow = 1)
las
confint(aov)
confint(aov)
setwd("~/Documents/Nonparametric/Project/NPSProject2526")
# Data cleaning - poverty_rate
poverty_rate = read.csv(file = "data/povertyRate.csv", header = T)
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)",]
View(poverty_rate)
# Data cleaning - poverty_rate
poverty_rate = read.csv(file = "data/povertyRate.csv", header = T)
poverty_rate = poverty_rate[,4:]
poverty_rate = poverty_rate[,-1:3]
poverty_rate = poverty_rate[,5:length(poverty_rate)]
View(poverty_rate)
poverty_rate = poverty_rate[,1:5]
View(poverty_rate)
unique(poverty_rate$sex)
unique(poverty_rate$age)
length(unique(poverty_rate$age))
# Calcolo delle frequenze per ogni età
frequenza_età <- table(poverty_rate$age)
print(frequenza_età)
View(poverty_rate)
poverty_total_total = poverty_rate[poverty_rate$age == 'Total',]
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total']
View(poverty_total_total)
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total',]
View(poverty_total_total)
View(poverty_total_total)
poverty_total_total = poverty_total_total[, 3:5]
View(poverty_total_total)
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
View(spr_expenditures)
unique(spr_expenditures$spfunc)
unique(poverty_total_total$geo)
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)"]
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)",]
poverty_total_total = poverty_rate[poverty_rate$age == 'Total',]
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total',]
poverty_total_total = poverty_total_total[, 3:5]
unique(poverty_total_total$geo)
unique(spr_expenditures$geo)
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area – 20 countries (from 2023)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 19 countries  (2015-2022)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (2007-2013)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (from 2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 28 countries (2013-2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 12 countries (2001-2006)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 18 countries (2014)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Economic Area except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Free Trade Association except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 15 countries (1995-2004)",]
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
{
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area – 20 countries (from 2023)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 19 countries  (2015-2022)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (2007-2013)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (from 2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 28 countries (2013-2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 12 countries (2001-2006)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 18 countries (2014)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Economic Area except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Free Trade Association except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 15 countries (1995-2004)",]
}
# pulizia colonne
spr_expenditures = spr_expenditures[,4:11]
unique(spr_expenditures$spfunc)
unique(spr_expenditures$spscheme)
spr_expenditures = spr_expenditures[,spr_expenditures$spscheme != "All scheme"]
spr_expenditures = spr_expenditures[, -c("spscheme")]
spr_expenditures$spscheme <- NULL
unique(spr_expenditures$spdep)
frequenza_spdep <- table(spr_expenditures$spdep)
print(frequenza_età)
print(frequenza_spdep)
spr_expenditures_bulgaria <- spr_expenditures[spr_expenditures$geo == "Bulgaria"]
spr_expenditures_bulgaria <- spr_expenditures[spr_expenditures$geo == "Bulgaria",]
View(spr_expenditures_bulgaria)
unique(spr)
unique(spr_expenditures_bulgaria$spdepm)
View(poverty_total_total)
names(poverty_total_total)[names(poverty_rate) == "OBS_VALUE"] <- "Poverty rate"
merge_spr_PovRate <- left_join(
x = spr_expenditures_matrix,      # Il dataset principale (left/sinistro)
y = poverty_total_total,  # Il dataset da cui prendere le nuove colonne (right/destro)
# Specifica le colonne (chiavi) su cui basare l'unione
by = c("Geopolitical.entity..reporting.", "TIME_PERIOD")
)
library(dplyr)
merge_spr_PovRate <- left_join(
x = spr_expenditures_matrix,      # Il dataset principale (left/sinistro)
y = poverty_total_total,  # Il dataset da cui prendere le nuove colonne (right/destro)
# Specifica le colonne (chiavi) su cui basare l'unione
by = c("Geopolitical.entity..reporting.", "TIME_PERIOD")
)
rm(list = ls())
graphics.off()
### Data cleaning - poverty_rate
poverty_rate = read.csv(file = "data/povertyRate.csv", header = T)
{
poverty_rate = poverty_rate[,5:length(poverty_rate)]
poverty_rate = poverty_rate[,1:5]
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)",]
poverty_total_total = poverty_rate[poverty_rate$age == 'Total',]
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total',]
poverty_total_total = poverty_total_total[, 3:5]
names(poverty_total_total)[names(poverty_rate) == "OBS_VALUE"] <- "Poverty rate"
}
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
# pulizia righe
{
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area – 20 countries (from 2023)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 19 countries  (2015-2022)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (2007-2013)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (from 2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 28 countries (2013-2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 12 countries (2001-2006)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 18 countries (2014)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Economic Area except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Free Trade Association except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 15 countries (1995-2004)",]
}
### seleziono l'unità di misura: Million euro (at constant 2015 prices)
unique(spr_expenditures$unit)
spr_expenditures = spr_expenditures[spr_expenditures$unit == "Million euro (at constant 2015 prices)", ]
spr_expenditures$unit <- NULL
# pulizia colonne
{
spr_expenditures$DATAFLOW <- NULL
spr_expenditures$LAST.UPDATE <- NULL
spr_expenditures$freq <- NULL
spr_expenditures$CONF_STATUS <- NULL
spr_expenditures$OBS_FLAG <- NULL
}
### seleziono spdepm == total ???
unique(spr_expenditures$spdepm)
spr_expenditures = spr_expenditures[spr_expenditures$spdepm == "Total",]
spr_expenditures$spdepm <- NULL
unique(spr_expenditures$spfunc)
unique(spr_expenditures$spscheme)
spr_expenditures$spscheme <- NULL
### seleziono spdep == "Social protection benefits" ???
unique(spr_expenditures$spdep)
frequenza_spdep <- table(spr_expenditures$spdep)
print(frequenza_spdep)
pr_expenditures = spr_expenditures[spr_expenditures$spdepm == "Social protection benefits",]
spr_expenditures$spdep <- NULL
library(dplyr)
library(tidyr)
spr_expenditures_matrix <- spr_expenditures %>%
# PASSO 1: Ordinare le righe
# Ordina il dataset per 'geo' e poi per 'TIME_PERIOD'
arrange(geo, TIME_PERIOD) %>%
# PASSO 2: Rimodellare i dati
pivot_wider(
# Le colonne che rimangono invariate e identificano le righe
id_cols = c(geo, TIME_PERIOD),
# La colonna i cui valori diventeranno i NOMI delle nuove colonne
names_from = spfunc,
# La colonna i cui valori riempiranno le nuove colonne
values_from = OBS_VALUE,
# RISOLUZIONE DUPLICATI: Calcola la media per qualsiasi valore duplicato ???
values_fn = sum
)
library(dplyr)
merge_spr_PovRate <- left_join(
x = spr_expenditures_matrix,      # Il dataset principale (left/sinistro)
y = poverty_total_total,  # Il dataset da cui prendere le nuove colonne (right/destro)
# Specifica le colonne (chiavi) su cui basare l'unione
by = c("Geopolitical.entity..reporting.", "TIME_PERIOD")
)
names(poverty_total_total)[names(poverty_rate) == "`Geopolitical.entity..reporting."] <- "geo"
names(poverty_total_total)[names(poverty_rate) == "Geopolitical.entity..reporting."] <- "geo"
rm(list = ls())
graphics.off()
### Data cleaning - poverty_rate
poverty_rate = read.csv(file = "data/povertyRate.csv", header = T)
{
poverty_rate = poverty_rate[,5:length(poverty_rate)]
poverty_rate = poverty_rate[,1:5]
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)",]
poverty_total_total = poverty_rate[poverty_rate$age == 'Total',]
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total',]
poverty_total_total = poverty_total_total[, 3:5]
names(poverty_total_total)[names(poverty_rate) == "OBS_VALUE"] <- "Poverty rate"
names(poverty_total_total)[names(poverty_rate) == "Geopolitical.entity..reporting."] <- "geo"
}
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
### Data cleaning - poverty_rate
poverty_rate = read.csv(file = "data/povertyRate.csv", header = T)
{
poverty_rate = poverty_rate[,5:length(poverty_rate)]
poverty_rate = poverty_rate[,1:5]
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)",]
poverty_total_total = poverty_rate[poverty_rate$age == 'Total',]
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total',]
poverty_total_total = poverty_total_total[, 3:5]
names(poverty_total_total)[names(poverty_total_total) == "OBS_VALUE"] <- "Poverty rate"
names(poverty_total_total)[names(poverty_total_total) == "Geopolitical.entity..reporting."] <- "geo"
}
View(poverty_total_total)
# PASSO 2: Crea il grafico con i dati filtrati
ggplot( data = data_subsample,
aes(x = TIME_PERIOD, y = OBS_VALUE, color = paese, group = paese)) +
geom_line(linewidth = 1.5) + # Linee grosse
geom_point(size = 3) +
scale_color_viridis(discrete = TRUE, option = "D") +
labs(
title = "Tassi di Povertà:",
x = "Periodo di Tempo",
y = "Tasso di Povertà"
)
rm(list = ls())
graphics.off()
### Data cleaning - poverty_rate
poverty_rate = read.csv(file = "data/povertyRate.csv", header = T)
{
poverty_rate = poverty_rate[,5:length(poverty_rate)]
poverty_rate = poverty_rate[,1:5]
poverty_rate = poverty_rate[poverty_rate$geo != "European Union - 27 countries (from 2020)",]
poverty_total_total = poverty_rate[poverty_rate$age == 'Total',]
poverty_total_total = poverty_total_total[poverty_total_total$sex == 'Total',]
poverty_total_total = poverty_total_total[, 3:5]
names(poverty_total_total)[names(poverty_total_total) == "OBS_VALUE"] <- "Poverty rate"
names(poverty_total_total)[names(poverty_total_total) == "Geopolitical.entity..reporting."] <- "geo"
}
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
# pulizia righe
{
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area – 20 countries (from 2023)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 19 countries  (2015-2022)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (2007-2013)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (from 2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 28 countries (2013-2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 12 countries (2001-2006)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 18 countries (2014)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Economic Area except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Free Trade Association except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 15 countries (1995-2004)",]
}
### seleziono l'unità di misura: Million euro (at constant 2015 prices)
unique(spr_expenditures$unit)
spr_expenditures = spr_expenditures[spr_expenditures$unit == "Million euro (at constant 2015 prices)", ]
spr_expenditures$unit <- NULL
# pulizia colonne
{
spr_expenditures$DATAFLOW <- NULL
spr_expenditures$LAST.UPDATE <- NULL
spr_expenditures$freq <- NULL
spr_expenditures$CONF_STATUS <- NULL
spr_expenditures$OBS_FLAG <- NULL
}
### seleziono spdepm == total ???
unique(spr_expenditures$spdepm)
spr_expenditures = spr_expenditures[spr_expenditures$spdepm == "Total",]
spr_expenditures$spdepm <- NULL
unique(spr_expenditures$spfunc)
unique(spr_expenditures$spscheme)
spr_expenditures$spscheme <- NULL
### seleziono spdep == "Social protection benefits" ???
unique(spr_expenditures$spdep)
frequenza_spdep <- table(spr_expenditures$spdep)
print(frequenza_spdep)
pr_expenditures = spr_expenditures[spr_expenditures$spdepm == "Social protection benefits",]
spr_expenditures$spdep <- NULL
library(dplyr)
library(tidyr)
spr_expenditures_matrix <- spr_expenditures %>%
# PASSO 1: Ordinare le righe
# Ordina il dataset per 'geo' e poi per 'TIME_PERIOD'
arrange(geo, TIME_PERIOD) %>%
# PASSO 2: Rimodellare i dati
pivot_wider(
# Le colonne che rimangono invariate e identificano le righe
id_cols = c(geo, TIME_PERIOD),
# La colonna i cui valori diventeranno i NOMI delle nuove colonne
names_from = spfunc,
# La colonna i cui valori riempiranno le nuove colonne
values_from = OBS_VALUE,
# RISOLUZIONE DUPLICATI: Calcola la media per qualsiasi valore duplicato ???
values_fn = sum
)
library(dplyr)
merge_spr_PovRate <- left_join(
x = spr_expenditures_matrix,      # Il dataset principale (left/sinistro)
y = poverty_total_total,  # Il dataset da cui prendere le nuove colonne (right/destro)
# Specifica le colonne (chiavi) su cui basare l'unione
by = c("geo", "TIME_PERIOD")
)
View(merge_spr_PovRate)
nCountries = length(unique(merge_spr_PovRate$geo))
nCountries
head(spr_expenditures)
summary(merge_spr_PovRate)
### seleziono l'unità di misura: Million euro (at constant 2015 prices)
unique(spr_expenditures$unit)
spr_expenditures = read.csv("data/sprExpenditures.csv", header = T)
# pulizia righe
{
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area – 20 countries (from 2023)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 19 countries  (2015-2022)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (2007-2013)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 27 countries (from 2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 28 countries (2013-2020)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 12 countries (2001-2006)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "Euro area - 18 countries (2014)",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Economic Area except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Free Trade Association except Liechtenstein",]
spr_expenditures = spr_expenditures[spr_expenditures$geo != "European Union - 15 countries (1995-2004)",]
}
### seleziono l'unità di misura: Million euro (at constant 2015 prices)
unique(spr_expenditures$unit)
spr_expenditures = spr_expenditures[spr_expenditures$unit == "Euro per inhabitant (at constant 2015 prices)", ]
spr_expenditures$unit <- NULL
# pulizia colonne
{
spr_expenditures$DATAFLOW <- NULL
spr_expenditures$LAST.UPDATE <- NULL
spr_expenditures$freq <- NULL
spr_expenditures$CONF_STATUS <- NULL
spr_expenditures$OBS_FLAG <- NULL
}
### seleziono spdepm == total ???
unique(spr_expenditures$spdepm)
spr_expenditures = spr_expenditures[spr_expenditures$spdepm == "Total",]
spr_expenditures$spdepm <- NULL
unique(spr_expenditures$spfunc)
unique(spr_expenditures$spscheme)
spr_expenditures$spscheme <- NULL
### seleziono spdep == "Social protection benefits" ???
unique(spr_expenditures$spdep)
frequenza_spdep <- table(spr_expenditures$spdep)
print(frequenza_spdep)
pr_expenditures = spr_expenditures[spr_expenditures$spdepm == "Social protection benefits",]
spr_expenditures$spdep <- NULL
library(dplyr)
library(tidyr)
spr_expenditures_matrix <- spr_expenditures %>%
# PASSO 1: Ordinare le righe
# Ordina il dataset per 'geo' e poi per 'TIME_PERIOD'
arrange(geo, TIME_PERIOD) %>%
# PASSO 2: Rimodellare i dati
pivot_wider(
# Le colonne che rimangono invariate e identificano le righe
id_cols = c(geo, TIME_PERIOD),
# La colonna i cui valori diventeranno i NOMI delle nuove colonne
names_from = spfunc,
# La colonna i cui valori riempiranno le nuove colonne
values_from = OBS_VALUE,
# RISOLUZIONE DUPLICATI: Calcola la media per qualsiasi valore duplicato ???
values_fn = sum
)
library(dplyr)
merge_spr_PovRate <- left_join(
x = spr_expenditures_matrix,      # Il dataset principale (left/sinistro)
y = poverty_total_total,  # Il dataset da cui prendere le nuove colonne (right/destro)
# Specifica le colonne (chiavi) su cui basare l'unione
by = c("geo", "TIME_PERIOD")
)
nCountries = length(unique(merge_spr_PovRate$geo))
nCountries
summary(merge_spr_PovRate)
write.csv(
x = merge_spr_PovRate,                 # Il data frame che vuoi salvare
file = "data/merge_spr_PovRate.csv",  # Il percorso e il nome del file di output
row.names = FALSE               # Opzionale, ma altamente consigliato
# Supponiamo che il tuo dataset si chiami 'dati_uniti'
#
write.csv(
# Supponiamo che il tuo dataset si chiami 'dati_uniti'
#
write.csv(
x = merge_spr_PovRate,                 # Il data frame che vuoi salvare
file = "data/merge_spr_PovRate.csv",  # Il percorso e il nome del file di output
row.names = FALSE               # Opzionale, ma altamente consigliato
)
data_2018 <- merge_spr_PovRate[merge_spr_PovRate$TIME_PERIOD == 2018, ]
ggplot(data_2018)
library(ggplot2)
ggplot(data_2018)
View(data_2018)
ggplot(data_2018[, 3:length(data_2018)])
View(data_2018)
plot(data_2018[, 3:15])
View(merge_spr_PovRate)
